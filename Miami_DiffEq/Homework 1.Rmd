---
title: "Online Assignment 9/9"
author: "RC"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{python}
import sympy as sy
import sympy.vector as sv
```

## 1

$$4xyy' = 4y^2+7x\sqrt{9x^2+y^2}$$
Find $F(x,y) = c$ given $x,y > 0$

$$y' = \frac{y}{x} + \frac{7}{4} \frac{\sqrt{9x^2+y^2}}{y}$$

Note that we can form a triangle with $\theta$, adjacent side $3x$, 
opposite side $y$, and hypotenuse $\sqrt{9x^2+y^2}$

$$tan(\theta) = \frac{y}{3x}$$

$$csc(\theta) = \frac{\sqrt{9x^2+y^2}}{y}$$

$$y = 3xtan(\theta)$$

$$y' = 3xsec^2(\theta) \theta ' + 3tan(\theta)$$

Plugging back into our equation:

$$(3xsec^2(\theta))\theta ' + 3tan(\theta) = 3tan(\theta) + \frac{7}{4} csc(\theta)$$

$$\theta' = \frac{\frac{7}{4} csc(\theta)}{3xsec^2(\theta)} = \frac{7}{12x} cos(\theta) cot(\theta)$$

$$\int sec(\theta) tan(\theta) d\theta = \int \frac{7}{12x} dx$$

$$sec(\theta) = \frac{7}{12} ln|x| + c$$

$$\frac{\sqrt{9x^2+y^2}}{3x} = \frac{7}{12} ln|x| + c$$

$$\frac{\sqrt{9x^2+y^2}}{3x} - \frac{7}{12} ln|x| = c$$

Simplifying while allowing the constant to change so we can match python

$$\frac{-4\sqrt{9x^2+y^2}}{7x} + ln|x| = c$$

$$\frac{-4\sqrt{9+y^2 / x^2}}{7} + ln|x| = c$$

Check...

```{python}
x = sy.Symbol('x')
f = sy.Function('f')
g = sy.dsolve(-4*f(x)**2 - 7*x*sy.sqrt(9*x**2 + f(x)**2) + 4*x*f(x)*f(x).diff(x), f(x))
sy.solve(g[1], sy.Symbol('C1'))
```

## 2

$$3xy^2y' = 15x^4+y^3$$

$$y' = 5 \frac{x^3}{y^2} + \frac{y}{3x}$$

Substitute $p = \frac{x}{y}$, $y=\frac{x}{p}$, $y'=p^{-1}-xp^{-2}p'$

$$\frac{1}{p}-\frac{x}{p^2}p' = 5xp^2+\frac{1}{3p}$$

$$-\frac{x}{p^2}p' = 5xp^2-\frac{2}{3p}$$

$$p' = -5p^4-\frac{2}{3x}p$$

$$p'-\frac{2}{3x}p = -5p^4$$

This is a Bernoulli form

$$y' + p(x)y=q(x)y^n$$

$$y^{-n}y' + p(x)y^{1-n}=q(x)$$

$$z = y^{1-n}$$

$$z' = (1-n)y^{-n}y'$$

$$\frac{1}{1-n}z'+p(x)z=q(x)$$
$$z'+(1-n)p(x)z=(1-n)q(x)$$

Plugging back into our equation... and creating a new variable $v$

$$v = p^{1-4}=p^3$$
$$v'+(-3)(\frac{-2}{3x})v = (-3)(-5)$$

$$v' + \frac{2}{x} v = 15$$

Solving as an ordinary differential equation

$$e^{\int 2/x dx} = e^{2ln|x|} = x^2$$

$$\int (x^2 v)' = \int x^2 (15) dx$$

$$x^2 v = 5x^3 + c$$

$$v = 5x + \frac{c}{x^2}$$

$$p^{-3} = 5x + \frac{c}{x^2}$$

$$\frac{y^3}{x^3} = 5x + \frac{c}{x^2}$$

$$y^3 = 5x^4 + cx$$

$$y = (5x^4 + cx)^{1/3}$$

Check...

```{python}
g = sy.dsolve(-15*x**4 - f(x)**3 + 3*x*f(x)**2*f(x).diff(x), f(x))
g[0].rhs
```



