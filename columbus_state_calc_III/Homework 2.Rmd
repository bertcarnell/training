---
title: "Weekly Assignment 2"
author: "RC"
date: "9/8/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{python}
import sympy as sy
import sympy.vector as sv

N = sv.CoordSys3D('N')
t = sy.Symbol('t')
```

## Question 1

### Part A

```{python}
P = -2*N.i + N.j - 3*N.k
Q = -1*N.i + 3*N.j + 4*N.k
R = 4*N.i + 5*N.j - 3*N.k
```

Line through R and Q

$$l_{QR}(t) = Q + (R-Q)t$$

$$l_{QR}(0) = Q,\ \ l_{QR}(1) = R$$

```{python}
print(f"Line through Q and R = {Q + (R-Q)*t}")
```

Line through P and parallel to QR

$$l_P(t') = P + (R-Q)t'$$

```{python}
print(f"Line through P parallel to QR = {P + (R-Q)*t}")
```

Check that they are parallel

$$l_P(1) - l_P(0) = \lambda (l_{QR}(1) - l_{QR}(0))$$

$$R-Q = \lambda(R-Q)$$

### Part B

```{python}
print(f"Another point on the line in A = {P + (R-Q)*2}")
```

### Part C

Solve 3 equations with 3 unknowns:

$$Ax + By + Cz = 0$$

or

$$z = Ax + By + D$$

$$-3 = D - 2A + B\\
4 = D - A + 3B\\
-3 = D + 4A + 5B$$

row 1 - row 3

$$ 0 = 0 - 6A - 4B,\ \ A = \frac{-2}{3} B$$

3 * row 2 + 4 * row 3

$$0 = 7D + 13A + 29B\\0 = 7D - \frac{26}{3}B + 29B\\0 = 21D + 61B\\D = \frac{-61}{21}B$$

plug back in

$$-3 = \frac{-61}{21}B - 2\frac{-2}{3} B + B$$

$$-63 = B(-61 + 28 + 21)\\B = \frac{-63}{-12} = \frac{21}{4}$$

$$A = \frac{-7}{2}$$

$$D = \frac{-61}{4}$$

$$z = \frac{-61}{4} - \frac{7}{2}x + \frac{21}{4}y$$

Using Linear Algebra ...

```{r}
X <- matrix(c(1,-2,1,1,-1,3,1,4,5), nrow = 3, byrow = TRUE)
Z <- matrix(c(-3, 4, -3), ncol = 1)
#solve(t(X)%*%X)%*%t(X)%*%Z
print(paste("D,A,B = ", paste(c(solve(X)%*%Z), collapse = ",")))
```

### Part D

Another point on the plane = <0, 0, -61/4>

## Question 2

Parametric equation of a line through $A = <2,-3,6>$ and perpendicular to 
$3x+2y-4z=7$

Picking off three points on the plane, forming 2 vectors in the plane, and finding
their cross product yields a vector perpendicular to the plane

```{python}
A = 2*N.i - 3*N.j + 6*N.k

# y=0, z=0
p1 = 7/3*N.i
# x=0, z=0
p2 = 7/2*N.j
# x=0, y=0
p3 = -7/4*N.k

# two vectors in the plane
v1 = p2 - p1
v2 = p3 - p1

print(f"Line through A, perpendicular to the plane = {A + v1.cross(v2)*24/49*t}")
```

## Question 3

Line of intersection of $5x+2y-z=4$ and $x-2y+3z=5$

Rewriting...

$$z = f(x,y) = 5x+2y-4\\
z = g(x,y) = \frac{-1}{3}x+\frac{2}{3}y -\frac{5}{3}$$

Setting equal

$$5x+2y-4  = \frac{-1}{3}x+\frac{2}{3}y -\frac{5}{3}$$

$$16x+4y-7=0$$

allow $x(t)=t$

$$y(t) = -4t+\frac{7}{4}$$

Plugging back into $f(x,y)$

$$z(t) = -3t-\frac{1}{2}$$

Checking against $g(x,y)$ shows these parameterizations are correct

$$-3t-\frac{1}{2} = \frac{-1}{3}t+\frac{2}{3}(-4t+\frac{7}{4}) -\frac{5}{3}$$

## Question 4

Find the exact coordinates of the point of intersection of the plane $x âˆ’ y + 2z = 9$ and the line
$x = 3 + 2t$, $y = 2-t$, $z=5t$

$$(3+2t) - (2-t) + 2(5t) = 9$$

$$t=\frac{8}{13}$$

coordinates = $<\frac{55}{13}, \frac{18}{13}, \frac{40}{13}$

check = `r abs(55/13 - 18/13 + 2*40/13 - 9) < 1E-9`

## Question 5

### A - Hyperboloid of one sheet

```{r}
f <- function(x,y) ifelse((x^2/5 + y^2/3 - 1) > 0, sqrt(16*(x^2/5 + y^2/3 - 1)), NA)
g <- function(x,y) ifelse((x^2/5 + y^2/3 - 1) > 0, -sqrt(16*(x^2/5 + y^2/3 - 1)), NA)
xseq <- seq(-10, 10, length = 50)
yseq <- seq(-10, 10, length = 50)
persp(x = xseq, y = yseq,
      z = matrix(f(rep(xseq, each=50), rep(yseq, times=50)), nrow=50, ncol=50),
      xlab="x", ylab="y", zlab="z")
persp(x = xseq, y = yseq,
      z = matrix(g(rep(xseq, each=50), rep(yseq, times=50)), nrow=50, ncol=50),
      xlab="x", ylab="y", zlab="z")
plot(x = xseq, y = f(xseq, rep(0, 50)), xlab = "x, y =  0", ylab = "z", ylim=c(-20, 20))
points(x = xseq, y = g(xseq, rep(0, 50)))

plot(x = yseq, y = f(rep(0, 50), yseq), xlab = "y, x =  0", ylab = "z", ylim=c(-20, 20))
points(x = yseq, y = g(rep(0, 50), yseq))
```

### B - Ellipsoid

$2x^2+5y^2+z^2=18$

```{r}
f <- function(x,y) ifelse((18 - 2*x^2 - 5*y^2) > 0, sqrt(18 - 2*x^2 - 5*y^2), NA)
g <- function(x,y) ifelse((18 - 2*x^2 - 5*y^2) > 0, -sqrt(18 - 2*x^2 - 5*y^2), NA)
xseq <- seq(-5, 5, length = 50)
yseq <- seq(-5, 5, length = 50)
persp(x = xseq, y = yseq,
      z = matrix(f(rep(xseq, each=50), rep(yseq, times=50)), nrow=50, ncol=50),
      xlab="x", ylab="y", zlab="z")
persp(x = xseq, y = yseq,
      z = matrix(g(rep(xseq, each=50), rep(yseq, times=50)), nrow=50, ncol=50),
      xlab="x", ylab="y", zlab="z")

plot(x = xseq, y = f(xseq, rep(0, 50)), xlab = "x, y =  0", ylab = "z", ylim=c(-20, 20))
points(x = xseq, y = g(xseq, rep(0, 50)))

plot(x = yseq, y = f(rep(0, 50), yseq), xlab = "y, x =  0", ylab = "z", ylim=c(-20, 20))
points(x = yseq, y = g(rep(0, 50), yseq))
```

### C - Hyperbolic Paraboloid

$2x^2-6y^2-3z=0$

```{r}
f <- function(x,y) 1/3*(2*x^2-6*y^2)
xseq <- seq(-10, 10, length = 50)
yseq <- seq(-10, 10, length = 50)
persp(x = xseq, y = yseq,
      z = matrix(f(rep(xseq, each=50), rep(yseq, times=50)), nrow=50, ncol=50),
      xlab="x", ylab="y", zlab="z")

plot(x = xseq, y = f(xseq, rep(0, 50)), xlab = "x, y =  0", ylab = "z", ylim=c(-20, 20))

plot(x = yseq, y = f(rep(0, 50), yseq), xlab = "y, x =  0", ylab = "z", ylim=c(-20, 20))
```

### D - Paraboloid

$4x^2 + 4y^2 = z$

```{r}
f <- function(x,y) 4*x^2 + 4*y^2
xseq <- seq(-10, 10, length = 50)
yseq <- seq(-10, 10, length = 50)
persp(x = xseq, y = yseq,
      z = matrix(f(rep(xseq, each=50), rep(yseq, times=50)), nrow=50, ncol=50),
      xlab="x", ylab="y", zlab="z")

plot(x = xseq, y = f(xseq, rep(0, 50)), xlab = "x, y =  0", ylab = "z", ylim=c(-20, 20))

plot(x = yseq, y = f(rep(0, 50), yseq), xlab = "y, x =  0", ylab = "z", ylim=c(-20, 20))
```

### E - Hyperboloid of two sheets??

$x^2+y^2=5z^2$

```{r}
f <- function(x,y) sqrt(1/5*(x^2 + y^2))
g <- function(x,y) -sqrt(1/5*(x^2 + y^2))
xseq <- seq(-10, 10, length = 50)
yseq <- seq(-10, 10, length = 50)
persp(x = xseq, y = yseq,
      z = matrix(f(rep(xseq, each=50), rep(yseq, times=50)), nrow=50, ncol=50),
      xlab="x", ylab="y", zlab="z")
persp(x = xseq, y = yseq,
      z = matrix(g(rep(xseq, each=50), rep(yseq, times=50)), nrow=50, ncol=50),
      xlab="x", ylab="y", zlab="z")
plot(x = xseq, y = f(xseq, rep(0, 50)), xlab = "x, y =  0", ylab = "z", ylim=c(-20, 20))
points(x = xseq, y = g(xseq, rep(0, 50)))

plot(x = yseq, y = f(rep(0, 50), yseq), xlab = "y, x =  0", ylab = "z", ylim=c(-20, 20))
points(x = yseq, y = g(rep(0, 50), yseq))
```


## Question 6

### A <-3,3,-2> to cylindrical

$$r = \sqrt{x^2+y^2} = \sqrt{18}$$

$$theta = tan^{-1}\frac{y}{x} = \frac{3\pi}{4}$$

check = `r abs(atan2(3, -3) - 3*pi/4) < 1E-9`

$$z = -2$$

### B <5, 2/3 \pi, 3/4 \pi> to Rectangular

$$x = \rho sin \phi cos \theta = 5 sin \frac{3\pi}{4} cos \frac{2\pi}{3} = 5 \frac{1}{\sqrt{2}} \frac{-1}{2} = \frac{-5}{2\sqrt{2}}$$
$$y = \rho sin \phi sin \theta = 5 sin \frac{3\pi}{4} sin \frac{2\pi}{3} = 5 \frac{1}{\sqrt{2}} \frac{\sqrt{3}}{2} = \frac{5\sqrt{3}}{2\sqrt{2}}$$

$$z = \rho cos \phi = 5 cos \frac{3\pi}{4} = \frac{-5}{\sqrt{2}}$$

## Question 7

### Part A

$$x^2 + y^2 -3x + z^2 = 25$$

Spherical

$$\rho^2 - 3\rho sin \phi cos \theta = 25$$

Cylindrical

$$r^2 - 3rcos\theta + z^2 = 25$$

### B

$$y^2+z^2=4$$

spherical

$$(\rho sin\phi cos\theta)^2 + (\rho cos\phi)^2 = 4$$

$$\rho^2(sin^2\phi sin^2\theta + cos^2\phi) = 4$$

Cylindrical

$$(rsin\theta)^2 + z^2 = 4$$

$$r^2 sin^2\theta + z^2 = 4$$

## Question 8

### Part A 

$$r = 2sin\theta$$

$$r^2 = 2rsin\theta$$
Rectangular

$$x^2 + y^2 = 2y$$

$$x^2 + y^2 -2y = 0$$

Spherical

$$(\rho sin\phi cos\theta)^2 + (\rho sin\phi sin\theta)^2 - 2\rho sin\phi sin\theta$$

$$\rho^2 sin^2\phi - 2\rho sin\phi sin\theta = 0$$

$$\rho sin\phi - 2sin\theta = 0$$

### Part B

$$\rho sin\phi = 5$$

$$\rho^2 sin^2\phi = 25$$

$$\rho^2 sin^2\phi cos^2\theta + \rho^2 sin^2\phi sin^2\theta = 25$$

Rectangular

$$x^2 + y^2 = 25$$

Cylindrical

$$r^2 = 25$$
